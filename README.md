Disclaimer
THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

# Thesis Repo

## Analysis and design of secure drone communication protocols

Welcome to the repository for the M.Sc. thesis *Analysis and design of secure drone communication protocols*. This repository contains security extensions to both versions of MAVLink. The extension and changes were made with efficiency in mind. It also provides forward secrecy. The original version of MAVLink has been extended with ECDH key-exchange and an 128-bit IV. The encryption scheme is AES in CBC mode. The IV is only included in the initial setup-message. The last block of the last received cipher serves as the IV in subsequent messages (handling it as one stream of blocks rather than separated messages). The MAC is a 16-byte tag generated by Chaskey. The IV session mitigates replay-attacks.

MAVLink v2.0 has been changed to support Chaskey instead of SHA256, keeping the same tag length. This version has two implementations: AES-CBC and AES-CTR. The CBC implementation works the exact same way as in the original version. CTR uses the timestamp as a nonce. ECDH is also available in v2.0. The exchanged messages are different to those of the first version. They will follow the format of the SETUP-SIGN message but with a 72 byte public-key as opposed to the 32-byte secret_key. 


### Completed tasks:

  1. Encryption in MAVLink v1.0
  2. General key generation helper-function
  3. Chaskey signatures in MAVLink v1.0
  4. Parser that adds padding and tag fields for appr. messages (payload length <= (255 - padding - 128bit tag))
  5. Added appr. header data to signature
  6. Added encryption scheme to MAVLink v2.0
  7. Changed signature scheme to Chaskey in MAVLink v2.0
  8. Added CTR mode in v2 with no padding (using 48-bit timestamp)
  9. Enabled ECDH key exchange in v2. Should work just as well in v1, but without a timestamp.
  10. Changed secure init in v1.0
  11. Added working v2.0 header files to the generator

### TODO prio. 1:



### TODO prio. 2:
  
  1. Add authenticated encryption for comparison
